name: bitfinex
  #  v1:
api_url: https://api-pub.bitfinex.com/v2/
rate_limit: null
  #    requests:
  #      ticker:
  #        rate_limit:
  #          max: 30
  #          unit: 60
  #        request:
  #          template: pubticker/{currency_pair}/
  #          pair_template: # e.g. btcusd
  #            template: "{first}{second}"
  #            lower_case: true
  #          params: null
  #        response:
  #          type: dict
  #          values:
  #            # price, (bid + ask) / 2
  #            mid:
  #              type:
  #              - str
  #              - float
  #            # price, Innermost bid
  #            bid:
  #              type:
  #              - str
  #              - float
  #            # price, Innermost ask
  #            ask:
  #              type:
  #              - str
  #              - float
  #            # price, The price at which the last order executed
  #            last_price:
  #              type:
  #              - str
  #              - float
  #            # price, Lowest trade price of the last 24 hours
  #            low:
  #              type:
  #              - str
  #              - float
  #            # price, Highest trade price of the last 24 hours
  #            high:
  #              type:
  #              - str
  #              - float
  #            # price, Trading volume of the last 24 hours
  #            volume:
  #              type:
  #              - str
  #              - float
  #            # time, The timestamp at which this information was valid
  #            timestamp:
  #              type:
  #              - str
  #              - float
  #              - utcfromtimestamp
  #    mapping:
  #    - key: ticker_best_bid
  #      path:
  #      - bid
  #      type:
  #      - str
  #      - float
  #    - key: ticker_best_ask
  #      path:
  #      - ask
  #      type:
  #      - str
  #      - float
  #    - key: ticker_last_price
  #      path:
  #      - last_price
  #      type:
  #      - str
  #      - float
  #    - key: ticker_daily_volume
  #      path:
  #      - volume
  #      type:
  #      - str
  #      - float
  #    - key: ticker_time
  #      path:
  #      - timestamp
  #      type:
  #      - str
  #      - float
  #      - utcfromtimestamp
  #
  #      stats: # not required
  #        rate_limit:
  #          max: 10
  #          unit: 60
  #        request:
  #          template: stats/{currency_pair}/
  #          values:
  #            currency_pair:
  #              template: "{first}{second}"
  #              lower_case: true
  #          params: null
  #        response:
  #          type: list
  #          values:
  #            # integer, Period covered in days
  #            period:
  #              type: int
  #            # price, Volume
  #            volume:
  #              type:
  #              - str
  #              - float
  #
  #      fundingbook: # not required
  #        rate_limit:
  #          max: 45
  #          unit: 60
  #        request:
  #          template: lendbook/{currency}/
  #          values:
  #            currency:
  #              template: "{currency}"
  #              lower_case: true
  #          params:
  #            # int, Limit the number of bids returned. May be 0 in which case the array of bids is empty
  #            limit_bids:
  #              type: int
  #              default: 50
  #            # int, Limit the number of asks returned. May be 0 in which case the array of asks is empty
  #            limit_asks:
  #              type: int
  #              default: 50
  #        response:
  #          type: dict
  #          values:
  #            # array of funding bids
  #            bids:
  #              type: list
  #              values:
  #                type: dict
  #                values:
  #                  # rate in % per 365 days
  #                  rate:
  #                    type:
  #                    - str
  #                    - float
  #                  # decimal
  #                  amount:
  #                    type:
  #                    - str
  #                    - float
  #                  # days, Minimum period for the margin funding contract
  #                  period:
  #                    type: int
  #                  # time
  #                  timestamp:
  #                    type:
  #                    - str
  #                    - float
  #                    - utcfromtimestamp
  #                  # yes/no, "Yes" if the offer is at Flash Return Rate, "No" if the offer is at fixed rate
  #                  frr:
  #                    type:
  #                    - str
  #                    - bool
  #            # array of funding offers
  #            asks:
  #              type: list
  #              values:
  #                type: dict
  #                values:
  #                  # rate in % per 365 days
  #                  rate:
  #                    type:
  #                    - str
  #                    - float
  #                  # decimal
  #                  amount:
  #                    type:
  #                    - str
  #                    - float
  #                  # days, Minimum period for the margin funding contract
  #                  period:
  #                    type: int
  #                  # time
  #                  timestamp:
  #                    type:
  #                    - str
  #                    - float
  #                    - utcfromtimestamp
  #                  # yes/no, "Yes" if the offer is at Flash Return Rate, "No" if the offer is at fixed rate
  #                  frr:
  #                    type:
  #                    - str
  #                    - bool
  #
  #      order_book:
  #        rate_limit:
  #          max: 30
  #          unit: 60
  #        request:
  #          template: book/{currency_pair}
  #          pair_template: # e.g. btcusd
  #            template: "{first}{second}"
  #            lower_case: true
  #          params:
  #            # int, Limit the number of bids returned. May be 0 in which case the array of bids is empty
  #            limit_bids:
  #              type: int
  #              default: 50
  #            # Limit the number of asks returned. May be 0 in which case the array of asks is empty
  #            limit_asks:
  #              type: int
  #              default: 50
  #            # 0 / 1, If 1, orders are grouped by price in the orderbook. If 0, orders are not grouped and sorted individually
  #            group:
  #              type:
  #              - int
  #              - bool
  #              default: 1
  #        response:
  #          type: dict
  #          values:
  #            bids:
  #              type: list
  #              values:
  #                type: dict
  #                values:
  #                  # price
  #                  price:
  #                    type:
  #                    - str
  #                    - float
  #                  # decimal
  #                  amount:
  #                    type:
  #                    - str
  #                    - float
  #                  # time
  #                  timestamp:
  #                    type:
  #                    - str
  #                    - float
  #                    - utcfromtimestamp
  #            asks:
  #              type: list
  #              values:
  #                type: dict
  #                values:
  #                  # price
  #                  price:
  #                    type:
  #                    - str
  #                    - float
  #                  # decimal
  #                  amount:
  #                    type:
  #                    - str
  #                    - float
  #                  # time
  #                  timestamp:
  #                    type:
  #                    - str
  #                    - float
  #                    - utcfromtimestamp
  #        mapping:
  #        - key: order_book_bids_price
  #          path:
  #          - bids
  #          - price
  #          type:
  #          - str
  #          - float
  #        - key: order_book_bids_size
  #          path:
  #          - bids
  #          - size
  #          type:
  #          - str
  #          - float
  #        - key: order_book_asks_price
  #          path:
  #          - asks
  #          - price
  #          type:
  #          - str
  #          - float
  #        - key: order_book_asks_size
  #          path:
  #          - asks
  #          - size
  #          type:
  #          - str
  #          - float
  #        - key: order_book_time
  #          path:
  #          - bids
  #          - timestamp
  #          type:
  #          - str
  #          - float
  #          - utcfromtimestamp
  #        - key: order_book_time
  #          path:
  #          - asks
  #          - timestamp
  #          type:
  #          - str
  #          - float
  #          - utcfromtimestamp
  #
  #      trades:
  #        rate_limit:
  #          max: 20
  #          unit: 60
  #        request:
  #          template: trades/{currency_pair}
  #          pair_template: # e.g. btcusd
  #            template: "{first}{second}"
  #            lower_case: true
  #          params:
  #            timestamp: # time, Only show trades at or after this timestamp
  #              type:
  #              - datetime
  #              - totimestamp
  #              required: false
  #            # int, Limit the number of trades returned. Must be >= 1
  #            limit_trades:
  #              type: int
  #              default: 50
  #        response:
  #          type: list
  #          values:
  #            type: dict
  #            values:
  #              # time
  #              timestamp:
  #                type:
  #                - int
  #                - utcfromtimestamp
  #              # int
  #              tid:
  #                type: int
  #              # price
  #              price:
  #                type:
  #                - str
  #                - float
  #              # decimal
  #              amount:
  #                type:
  #                - str
  #                - float
  #              # string, "bitfinex"
  #              exchange:
  #                type: str
  #              # string, sell or buy or empty string
  #              type:
  #                type: str
  #        mapping:
  #        - key: trade_time
  #          path:
  #          - timestamp
  #          type:
  #          - int
  #          - utcfromtimestamp
  #        - key: trade_last_price
  #          path:
  #          - price
  #          type:
  #          - str
  #          - float
  #        - key: trade_amount
  #          path:
  #          - str
  #          - float
  #        - key: trade_side
  #          path:
  #          - type
  #          type:
  #          - str
  #
  #      lends: # not required
  #        rate_limit:
  #          max: 60
  #          unit: 60
  #        request:
  #          template: lends/{currency}/
  #          values:
  #            currency:
  #              template: "{currency}"
  #              lower_case: true
  #          params:
  #            # time, Only show trades at or after this timestamp
  #            timestamp:
  #              type:
  #              - int
  #              - utctotimestamp  # TODO
  #            # int, Limit the number of trades returned. Must be >= 1
  #            limit_lends:
  #              type: int
  #              min: 1
  #              default: 50
  #        response:
  #          type: list
  #          values:
  #            type: dict
  #            values:
  #              # decimal, % by 365 days, Average rate of total funding received at fixed rates, ie past Flash Return Rate annualized
  #              rate:
  #                type:
  #                - str
  #                - float
  #              # decimal, Total amount of open margin funding in the given currency
  #              amount_lent:
  #                type:
  #                - str
  #                - float
  #              # decimal, Total amount of open margin funding used in a margin position in the given currency
  #              amount_used:
  #                type:
  #                - str
  #                - float
  #              # time
  #              timestamp:
  #                type:
  #                - int
  #                - utcfromtimestamp
  #
  #      currency_pairs:
  #        rate_limit:
  #          max: 5
  #          unit: 60
  #        request:
  #          template: symbols/
  #          pair_template: null
  #          params: null
  #        response:
  #          type: list
  #          values: # "btcusd", "ltcusd", "ltcbtc", ...
  #            type: str
  #        mapping:
  #        - key: currency_pair_first
  #          path:
  #          - 0
  #          type:
  #          - str
  #          - split
  #          - ""
  #        - key: currency_pair_second
  #          path:
  #          - 1
  #          type:
  #          - str
  #          - split
  #          - ""
  #
  #      symbols_details: # not required
  #        rate_limit:
  #          max: 5
  #          unit: 60
  #        request:
  #          template: symbols_details/
  #          params: null
  #        response:
  #          type: list
  #          values:
  #            type: dict
  #            values:
  #              # string, The pair code
  #              pair:
  #                type: str
  #              # integer, Maximum number of significant digits for price in this pair
  #              price_precision:
  #                type: int
  #              # decimal, Initial margin required to open a position in this pair
  #              initial_margin:
  #                type:
  #                - str
  #                - float
  #              # decimal, Minimal margin to maintain (in %)
  #              minimum_margin:
  #                type:
  #                - str
  #                - float
  #              # decimal, Maximum order size of the pair
  #              maximum_order_size:
  #                type:
  #                - str
  #                - float
  #              # decimal, Minimum order size of the pair
  #              minimum_order_size:
  #                type:
  #                - str
  #                - float
  #              # string, Expiration date for limited contracts/pairs
  #              expiration:
  #                type: str
  #              # boolean, margin trading enabled for this pair
  #              margin:
  #                type: bool

  #  v2:
requests:
  currency_pairs:
    request:
      template: /conf/pub:list:pair:exchange
      pair_template: null
      params: null
    response:
      type: list
      values:
        type: list
        values:
          type: str
    mapping:
      - key: currency_pair_first
        path:
         - []
        type:
          - str
          - split_at_del_or_index
          - ':'
          - 3
          - 0
      - key: currency_pair_second
        path:
          - []
        type:
          - str
          - split_at_del_or_index
          - ':'
          - 3
          - 1

  ticker:
    request:
      template: tickers
      pair_template: # i.e. tBTCUSD
        template: "t{first}{second}"
        lower_case: false
        alias: symbols
      params: null
    response:
      type: list
      values:
        type: list
        values:
        # template on trading pairs (ex. tBTCUSD)
          0: # SYMBOL: The currency symbol
            type: str
          1: # BID: Price of last highest bid
            type: float
          2: # BID_SIZE: Size of the last highest bid
            type: float
          3: # ASK: Price of last lowest ask
            type: float
          4: # ASK_SIZE: Size of the last lowest ask
            type: float
          5: # DAILY_CHANGE: Amount that the last price has changed since yesterday
            type: float
          6: # DAILY_CHANGE_PERC: Amount that the price has changed expressed in percentage terms
            type: float
          7: # LAST_PRICE: Price of the last trade
            type: float
          8: # VOLUME: Daily volume
            type: float
          9: # HIGH: Daily high
            type: float
          10: # LOW: Daily low
            type: float
          # template on funding currencies (ex. fUSD)
    mapping: # for trading pairs (ex. tBTCUSD)
      - key: time
        path: [ ]
        type:
          - none
          - now
      - key: best_bid
        path:
          - 1
        type:
          - float
      - key: best_ask
        path:
          - 3
        type:
          - float
      - key: last_price
        path:
          - 7
        type:
          - float
      - key: daily_volume
        path:
          - 8
        type:
          - float

#  ticker: # not required
#    request:
#      template: ticker/{currency_pair}/
#      pair_template: # i.e. tBTCUSD
#        template: "t{first}{second}"
#        lower_case: false
#      params: null
#    response:
#      type: list
#      values:
#        # template on trading pairs (ex. tBTCUSD)
#        - 0: # Price of last highest bid
#            type: float
#          1: # BID_SIZE: Size of the last highest bid
#            type: float
#          2: # ASK: Price of last lowest ask
#            type: float
#          3: # ASK_SIZE: Size of the last lowest ask
#            type: float
#          4: # DAILY_CHANGE: Amount that the last price has changed since yesterday
#            type: float
#          5: # DAILY_CHANGE_PERC: Amount that the price has changed expressed in percentage terms
#            type: float
#          6: # LAST_PRICE: Price of the last trade
#            type: float
#          7: # VOLUME: Daily volume
#            type: float
#          8: # HIGH: Daily high
#            type: float
#          9: # LOW: Daily low
#            type: float
#        # template on funding currencies (ex. fUSD)
#        - 0: # FRR: Flash Return Rate - average of all fixed rate funding over the last hour
#            type: float
#          1: # BID: Price of last highest bid
#            type: float
#          2: # BID_SIZE: Size of the last highest bid
#            type: float
#          3: # BID_PERIOD: Bid period covered in days
#            type: int
#          4: # ASK: Price of last lowest ask
#            type: float
#          5: # ASK_SIZE: Size of the last lowest ask
#            type: float
#          6: # ASK_PERIOD: Ask period covered in days
#            type: int
#          7: # DAILY_CHANGE: Amount that the last price has changed since yesterday
#            type: float
#          8: # DAILY_CHANGE_PERC: Amount that the price has changed expressed in percentage terms
#            type: float
#          9: # LAST_PRICE: Price of the last trade
#            type: float
#          10: # VOLUME: Daily volume
#            type: float
#          11: # HIGH: Daily high
#            type: float
#          12: # LOW: Daily low
#            type: float

  trades:
    request:
      template: trades/{currency_pair}/hist
      pair_template: # i.e. tBTCUSD
        template: "t{first}{second}"
        lower_case: false
      params:
        limit: # Number of records
          type: int
          default: 120
        start: # Millisecond start time
          type:
            - datetime
            - totimestampms
          required: false
        end: # Millisecond end time
          type:
            - datetime
            - totimestampms
          required: false
        sort: # if = 1 it sorts results returned with old > new
          type: int
          allowed:
            - 1
            - -1
          default: -1
    response:
      type: list
      values:
        type: list
        values:
          # template on trading pairs (ex. tBTCUSD)
          - 0: # ID
              type: int
            1: # MTS: millisecond time stamp
              type:
                - int
                - fromtimestampms
            2: # AMOUNT: How much was bought (positive) or sold (negative).
              type: float
            3: # PRICE: Price at which the trade was executed
              type: float
          # template on funding currencies (ex. fUSD)
          - 0: #ID
              type: int
            1: # MTS: millisecond time stamp
              type: int
            2: # AMOUNT: How much was bought (positive) or sold (negative).
              type: float
            3: # RATE: Rate at which funding transaction occurred
              type: float
            4: # PERIOD: Amount of time the funding transaction was for
              type: int
    mapping: # for trading pairs (ex. tBTCUSD)
      - key: trade_time
        path:
          - 1
        type:
          - int
          - fromtimestampms
      - key: trade_amount
        path:
          - 2
        type:
          - float
      - key: trade_last
        path:
          - 3
        type:
          - float

  order_book:
    request:
      template: book/{currency_pair}/{precision}
      pair_template: # i.e. tBTCUSD
        template: "t{first}{second}"
        lower_case: false
      params:
        precision: # Level of price aggregation (P0, P1, P2, P3, P4, R0)
          type: str
          allowed:
            - "P0"
            - "P1"
            - "P2"
            - "P3"
            - "P4"
            - "R0"
          required: true
        len: # Number of price points ("25", "100")
          type: int
          allowed:
            - 25
            - 100
          required: false
    response:
      type: list
      values:
        type: list
        values:
          # template on trading pairs (ex. tBTCUSD)
          - 0: # PRICE: Price level
              type: float
            1: # COUNT: Number of orders at that price level
              type: int
            2: # AMOUNT: Total amount available at that price level. For Trading: if AMOUNT > 0 then bid else ask.
              type: float
          # template on funding currencies (ex. fUSD)
          - 0: # RATE: Rate level
              type: float
            1: # PERIOD: Period level (Funding only)
              type: float
            2: # COUNT: Number of orders at that price level
              type: int
            3: # AMOUNT: Total amount available at that price level. For Funding: if AMOUNT > 0 then ask else bid.
              type: float
    mapping: # for trading pairs (ex. tBTCUSD), if AMOUNT > 0 then bid else ask.
      - key: order_book_time
        path: [ ]
        type:
          - none
          - now
      # if AMOUNT < 0
      - key: order_book_asks_price
        path:
          - 0
        type:
          - float
      - key: order_book_asks_size
        path:
          - 2
        type:
          - float
      # if AMOUNT > 0
      - key: order_book_bids_price
        path:
          - 0
        type:
          - float
      - key: order_book_bids_size
        path:
          - 2
        type:
          - float

  stats: # not required
    request:
      template: stats1/{key}:{size}:{symbols}:{side}/{section}/
      values:
        key:
          - template: "{str}.{str}"
            lower_case: true
            allowed:
              # Total Active Funding
              # Arguments: :1m:SYM_FUNDING, i.e.: funding.size:1m:fUSD
              - "funding.size"
              # Active Funding used in positions
              # Arguments: :1m:SYM_FUNDING, i.e.: credits.size:1m:fUSD
              - "credits.size"
              # Total Open Position (long/short)
              # Arguments: :1m:SYM_TRADING:SIDE, i.e.: pos.size:1m:tBTCUSD:long, pos.size:1m:tBTCUSD:short
              - "pos.size"
          - template: "{str}.{str}.{str}"
            lower_case: true
            allowed:
              # Active Funding used in positions (per trading symbol)
              # Arguments: :1m:SYM_FUNDING:SYM_TRADING, i.e.: credits.size.sym:1m:fUSD:tBTCUSD
              - "credits.size.sym"
        size:
          template: "{int}{str}"
          lower_case: true
          allowed: "1m"
        symbols:
          - template: "t{first}{second}"
            lower_case: false
          - template: "f{currency}"
            lower_case: false
        side:
          template: "{str}"
          lower_case: true
          allowed:
            - "long"
            - "short"
        section:
          template: "{str}"
          lower_case: true
          allowed:
            - "last"
            - "hist"
      params:
        sort: # if = 1 it sorts results returned with old > new
          type: int
    response:
      type: list
      values:
        # response with Section = "last"
        - 0: # MTS: millisecond timestamp
            type: int
          1: # VALUE :Total amount
            type: float
        # response with Section = "hist"
        - type: list
          values:
            0: # MTS: millisecond timestamp
              type: int
            1: # VALUE :Total amount
              type: float

  historic_rates:
    request:
      template: candles/trade:{timeframe}:{currency_pair}/{section}
      pair_template: # i.e. tBTCUSD
        template: "t{first}{second}"
        lower_case: false
      params:
        timeframe:
          type: str
          allowed:
            - "1m"
            - "5m"
            - "15m"
            - "30m"
            - "1h"
            - "3h"
            - "6h"
            - "12h"
            - "1D"
            - "7D"
            - "14D"
            - "1M"
          required: true
        section:
          type: str
          allowed:
            - "last"
            - "hist"
          required: true
        limit: # Number of candles requested
          type: int
          required: false
        start: # Filter start (ms)
          type:
            - datetime
            - totimestampms
          required: false
        end: # Filter end (ms)
          type:
            - datetime
            - totimestampms
          required: false
        sort: # if = 1 it sorts results returned with old > new
          type: int
          required: false
    response:
      type: list
      values:
        # response with Section = "last"
        - 0: # MTS: millisecond time stamp
            type:
              - int
              - fromtimestampms
          1: # OPEN: First execution during the time frame
            type: float
          2: # CLOSE: Last execution during the time frame
            type: float
          3: # HIGH: Highest execution during the time frame
            type: float
          4: # LOW: Lowest execution during the timeframe
            type: float
          5: # VOLUME: Quantity of symbol traded within the timeframe
            type: float
        # response with Section = "hist"
        - type: list
          values:
            0: # MTS: millisecond time stamp
              type:
                - int
                - fromtimestampms
            1: # OPEN: First execution during the time frame
              type: float
            2: # CLOSE: Last execution during the time frame
              type: float
            3: # HIGH: Highest execution during the time frame
              type: float
            4: # LOW: Lowest execution during the timeframe
              type: float
            5: # VOLUME: Quantity of symbol traded within the timeframe
              type: float
    mapping: # for trading pairs (ex. tBTCUSD)
      - key: historic_rates_time
        path:
          - 0
        type:
          - int
          - fromtimestampms
      - key: historic_rates_open
        path:
          - 1
        type:
          - float
      - key: historic_rates_close
        path:
          - 2
        type:
          - float
      - key: historic_rates_high
        path:
          - 3
        type:
          - float
      - key: historic_rates_low
        path:
          - 4
        type:
          - float
      - key: historic_rates_volume
        path:
          - 5
        type:
          - float
