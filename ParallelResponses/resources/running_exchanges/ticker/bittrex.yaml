#TODO: für historic rates muss das intervall mit im String übergeben werden,
# OrderBooks leider ohne ID
# leider können wir bis jetzt nur das currency_pair in den String einfügern
name: bittrex
exchange: true
api_url: https://api.bittrex.com/api/v1.1/public/
rate_limit: null


requests:
  currency_pairs:
    request:
      template: getmarkets
      pair_template: null
      params: null
    response:
      type: dict
      values:
        success:
          type: bool
          message:
            type: str
            result:
              type: list
              values:
                type: dict
                values:
                  MarketCurrency:
                    type: str
                  BaseCurrency:
                    type: str
                  BaseCurrencyLong:
                    type: str
                  MinTradeSize:
                    type: float
                  MarketName:
                    type: str
                  IsActive:
                    type: bool
                  IsRestricted:
                    type: bool
                  Created:
                    type: str
                  Notice:
                    type: str
                  IsSponsored:
                    type: str
                  LogoUrl:
                    type: str

    mapping:
      - key: currency_pair_first
        path:
          - result
          - BaseCurrency
        type:
          - str
      - key: currency_pair_second
        path:
          - result
          - MarketCurrency
        type:
          - str

  ticker:
    request:
      template: getmarketsummaries
      pair_template: null
      params: null
    response:
      type: dict
      values:
        message:
          type: str
        success:
          type: bool
        result:
          type: list
          value:
            type: dict
            values:
              MarketName:
                type: str
              High:
                type: float
              Low:
                type: float
              Volume:
                type: float
              Last:
                type: float
              BaseVolume:
                type: float
              Timestamp:
                type: str
              Bid:
                type: float
              Ask:
                type: float

    mapping:
    - key: currency_pair_first
      path:
        - result
        - MarketName
      type:
        - str
        - split
        - "-"
        - 0
    - key: currency_pair_second
      path:
        - result
        - MarketName
      type:
        - str
        - split
        - "-"
        - 1
    - key: ticker_last_price
      path:
        - result
        - Last
      type:
        - float
    - key: ticker_time
      path:
        - result
        - Timestamp
      type:
        - str
        - strptime
        - "%Y-%m-%dT%H:%M:%S.%f"
    - key: ticker_best_bid
      path:
        - result
        - Bid
      type:
        - float
    - key: ticker_best_ask
      path:
        - result
        - Ask
      type:
        - float
    - key: ticker_daily_volume
      path:
        - result
        - BaseVolume
      type:
        - float


  trades:
    request:
      template: getmarkethistory
      pair_template:
        template: "{first}-{second}"
        lower_case: false
        alias: market
      params: null
    response:
      type: dict
      values:
        success:
          type: bool
        message:
          type: str
        result:
          type: list
          values:
            type: dict
            values:
              Id:
                type: int
              TimeStamp:
                type:
                - str
              Quantity:
                type: float
              Price:
                type: float
              Total:
                type: float
              FillType:
                type: str
              OrderType:
                type: str

    mapping:
    - key: time
      path:
      - result
      - TimeStamp
      type:
      - strptime_w_f
      - strptime_wo_f
      - "%Y-%m-%dT%H:%M:%S"
    - key: amount
      path:
      - result
      - Quantity
      type:
      - float
    - key: price
      path:
      - result
      - Price
      type:
      - float
    - key: direction
      path:
      - result
      - OrderType
      type:
      - str
      - lower
    - key: id
      path:
        - result
        - Id
      type:
        - int




  # order_book:
    # request:
      # template: getorderbook
      # pair_template:
        # template: "{first}-{second}"
        # lower_case: false
        # alias: market
      # params:
        # type:
          # type: str
          # allowed:
          # - buy
          # - sell
          # - both
          # default: both
    # response:
      # type: dict
      # values:
        # success:
          # type: bool
        # message:
          # type: str
        # result:
          # type: dict
          # values:
            # buy:
              # type: list
              # values:
                # type: dict
                # values:
                  # Quantity:
                    # type: float
                  # Rate:
                    # type: float
            # sell:
              # type: list
              # values:
                # type: dict
                # values:
                  # Quantity:
                    # type: float
                  # Rate:
                    # type: float
    # mapping:
    # - key: order_book_time
      # path: []
      # type:
      # - none
      # - now
    # - key: order_book_bids_price
      # path:
      # - result
      # - buy
      # - Rate
      # type:
      # - float
    # - key: order_book_bids_size
      # path:
      # - result
      # - buy
      # - Quantity
      # type:
      # - float
    # - key: order_book_asks_price
      # path:
      # - result
      # - sell
      # - Rate
      # type:
      # - float
    # - key: order_book_asks_size
      # path:
      # - result
      # - sell
      # - Quantity
      # type:
      # - float
