#historic rates fehlerhaft
name: abucoins
api_url: https://api.abucoins.com/
rate_limit:
  max: 300
  #unit in seconds
  unit: 60
requests:
  currency_pairs:
    request:
      template: products
      values: null
      params: null
    response:
      type: list
      values:
        type: dict
        values:
          id:
            type: str
          base_currency:
            type: str
          quote_currency:
            type: str
          base_min_size:
            type:
            - str
            - float
          base_max_size:
            type:
            - str
            - float
          quote_increment:
            type:
            - str
            - float
          display_name:
            type: str
    mapping:
    - key: currency_pair_first
      path:
      - base_currency
      type:
      - str
    - key: currency_pair_second
      path:
      - quote_currency
      type:
      - str

  order_book:
    request:
      template: products/{currency_pair}/book
      values:
        currency_pair:
          template: "{first}-{second}"
          lower_case: false
      params:
        level:
          type: int
          default: 0
          allowed:
          - 0 # fully aggregated order book
          - 1 # best ask and bid
          - 2 # top 50 asks and bids
    response:
      type: dict
      values:
        asks:
          type: list
          values:
            type: list
            values:
              0: # price
                type:
                - str
                - float
              1: # size
                type:
                - str
                - float
              2: # num-orders
                type: int
        bids:
          type: list
          values:
            type: list
            values:
              0: # price
                type:
                - str
                - float
              1: # size
                type:
                - str
                - float
              2: # num-orders
                type: int
        sequence:
          type: int
    mapping:
    - key: order_book_asks_price
      path:
      - asks
      - 0
      type:
      - str
      - float
    - key: order_book_asks_size
      path:
      - asks
      - 1
      type:
      - str
      - float
    - key: order_book_bids_price
      path:
      - bids
      - 0
      type:
      - str
      - float
    - key: order_book_bids_size
      path:
      - bids
      - 1
      type:
      - str
      - float

  ticker:
    request:
      template: products/ticker
      values: null
      params: null
    response:
      type: list
      values:
        type: dict
        values:
          product_id: # e.g. ETH-BTC
            type:
            - str
            - split
            - "-"
          trade_id:
            type:
            - str
            - int
          price:
            type:
            - str
            - float
          size:
            type:
            - str
            - float
          bid:
            type:
            - str
            - float
          ask:
            type:
            - str
            - float
          volume: # 24h
            type:
            - str
            - float
          time:
            type:
            - str
            - strptime
            - "%Y-%m-%dT%H:%M:%SZ"
    mapping:
    - key: currency_pair_first
      path:
      - product_id
      - 0
      type:
      - str
      - split
      - "-"
    - key: currency_pair_second
      path:
      - product_id
      - 1
      type:
      - str
      - split
      - "-"
    - key: ticker_last_price
      path:
      - price
      type:
      - str
      - float
    - key: ticker_best_bid
      path:
      - bid
      type:
      - str
      - float
    - key: ticker_best_ask
      path:
      - ask
      type:
      - str
      - float
    - key: ticker_daily_volume
      path:
      - volume
      type:
      - str
      - float
    - key: ticker_time
      path:
      - time
      type:
      - str
      - strptime
      - "%Y-%m-%dT%H:%M:%SZ"

  trades:
    request:
      template: products/{currency_pair}/trades
      values:
        currency_pair:
          template: "{first}-{second}"
          lower_case: false
      params:
        before: # newer than pagination id
          type: int
        after: # older than pagination id
          type: int
        limit:
          type: int
          default: 100
          min: 0
          max: 1000
    response:
      type: list
      values:
        type: dict
        values:
          time:
            type:
            - str
            - strptime
            - "%Y-%m-%dT%H:%M:%SZ"
          trade_id:
            type: str
          price: # last price
            type:
            - str
            - float
          size: # size/amount of the last trade
            type:
            - str
            - float
          side: # "sell" or "buy"
            type: str
            allowed:
            - sell
            - buy
    mapping:
    - key: trade_time
      path:
      - time
      type:
      - str
      - strptime
      - "%Y-%m-%dT%H:%M:%SZ"
    - key: trade_last_price
      path:
      - price
      type:
      - str
      - float
    - key: trade_amount
      path:
      - size
      type:
      - str
      - float
    - key: trade_side
      path:
      - side
      type:
      - str

  historic_rates:
    request:
      template: products/{currency_pair}/candles
      values:
        currency_pair:
          template: "{first}-{second}"
          lower_case: false
      params:
        start: # Max 30 days before now
          type:
          - datetime
          - strftime
          - "%Y-%m-%dT%H:%M:%S.%fZ"
        end:
          type:
          - datetime
          - strftime
          - "%Y-%m-%dT%H:%M:%S.%fZ"
        granularity:
          type: int
          min: 0
    response:
      type: list
      values:
        type: list
        values:
          0: # time
            type:
            - str
            - int
            - fromtimestamp
          1: # low
            type:
            - str
            - float
          2: # high
            type:
            - str
            - float
          3: # open
            type:
            - str
            - float
          4: # close
            type:
            - str
            - float
          5: # volume
            type:
            - str
            - float
    mapping:
    - key: historic_rates_time
      path:
      - 0
      type:
      - str
      - int
      - fromtimestamp
    - key: historic_rates_low
      path:
      - 1
      type:
      - str
      - float
    - key: historic_rates_high
      path:
      - 2
      type:
      - str
      - float
    - key: historic_rates_open
      path:
      - 3
      type:
      - str
      - float
    - key: historic_rates_close
      path:
      - 4
      type:
      - str
      - float
    - key: historic_rates_volume
      path:
      - 5
      type:
      - str
      - float
